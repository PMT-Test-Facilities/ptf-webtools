<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 TRANSITIONAL//EN">
<html><head>
<title>Helmholtz Coil Control</title>
<!--
<link rel="stylesheet" href="http://ladd00.triumf.ca/~lindner/general/buttons2.css" media="screen" /> -->
<link rel="stylesheet" href="buttons2.css" media="screen" />
<!-- <link rel="stylesheet" href="http://ladd00.triumf.ca/~lindner/cdms/cdms_style.css" media="screen" /> -->

<script type="text/javascript">
$("a").hover(function(e) {
    $($(this).data("tooltip")).css({
        left: e.pageX + 1,
        top: e.pageY + 1
    }).stop().show(100);
}, function() {
    $($(this).data("tooltip")).hide();
});
</script>
<script type="text/javascript" src="../mhttpd.js"></script>
<script type="text/javascript" src="../obsolete.js"></script>

<script>
var mongodb = require('mongodb');
    var server = new mongodb.Server("127.0.0.1", 27017, {});
    new mongodb.Db('test', server, {}).open(function (error, client) {
      if (error) throw error;
      var collection = new mongodb.Collection(client, 'test_collection');
      collection.find({}, {limit:10}).toArray(function(err, docs) {
        console.dir(docs);
      });
    });
</script>
<script>
function coil_stop()
{
ODBSet("/Equipment/PtfWiener/Settings/outputSwitch[8]","0");
ODBSet("/Equipment/PtfWiener/Settings/outputSwitch[9]","0");
ODBSet("/Equipment/PtfWiener/Settings/outputSwitch[0]","0");
ODBSet("/Equipment/PtfWiener/Settings/outputSwitch[1]","0");
ODBSet("/Equipment/PtfWiener/Settings/outputSwitch[2]","0");
ODBSet("/Equipment/PtfWiener/Settings/outputSwitch[4]","0");
ODBSet("/Equipment/PtfWiener/Settings/mainSwitch","0");
}
</script>
<script>
function coil_switch_on()
{
ODBSet("/Equipment/PtfWiener/Settings/mainSwitch","1");
ODBSet("/Equipment/PtfWiener/Settings/outputSwitch[8]","1");
ODBSet("/Equipment/PtfWiener/Settings/outputSwitch[9]","1");
ODBSet("/Equipment/PtfWiener/Settings/outputSwitch[0]","1");
ODBSet("/Equipment/PtfWiener/Settings/outputSwitch[1]","1");
ODBSet("/Equipment/PtfWiener/Settings/outputSwitch[2]","1");
ODBSet("/Equipment/PtfWiener/Settings/outputSwitch[4]","1");
}
</script>
<script>
function degauss_x_cyclotron_ON()
{
<!-- Degauss in x (coils 3 & 4) -->
ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[2]","0.35");
ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[4]","0");
setTimeout( function(){ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[2]","2.80")}, 5000);
setTimeout( function(){ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[4]","2.54")}, 5000);
setTimeout( function(){ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[2]","1.52")}, 10000);
setTimeout( function(){ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[4]","1.24")}, 10000);
setTimeout( function(){ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[2]","2.19")}, 15000);
setTimeout( function(){ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[4]","1.91")}, 15000);
setTimeout( function(){ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[2]","1.84")}, 20000);
setTimeout( function(){ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[4]","1.56")}, 20000);
setTimeout( function(){ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[2]","2.02")}, 25000);
setTimeout( function(){ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[4]","1.75")}, 25000);
setTimeout( function(){ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[2]","1.93")}, 30000);
setTimeout( function(){ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[4]","1.66")}, 30000);
setTimeout( function(){ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[2]","1.96")}, 35000);
setTimeout( function(){ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[4]","1.69")}, 35000);
setTimeout( function(){ODBGenerateMsg("Degaussing X field DONE!","midas","midptf","")},40000);
}
</script>
<script>
function degauss_y_cyclotron_ON()
{
<!-- Degauss in y (coils 5 & 6) -->

ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[1]","0.69");
ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[0]","0");
setTimeout( function(){ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[1]","2.8")}, 5000);
setTimeout( function(){ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[0]","2.01")}, 5000);
setTimeout( function(){ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[1]","1.30")}, 10000);
setTimeout( function(){ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[0]","0.63")}, 10000);
setTimeout( function(){ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[1]","2.3")}, 15000);
setTimeout( function(){ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[0]","1.61")}, 15000);
setTimeout( function(){ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[1]","1.60")}, 20000);
setTimeout( function(){ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[0]","0.93")}, 20000);
setTimeout( function(){ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[1]","2.15")}, 25000);
setTimeout( function(){ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[0]","1.42")}, 25000);
setTimeout( function(){ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[1]","1.78")}, 30000);
setTimeout( function(){ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[0]","1.08")}, 30000);
setTimeout( function(){ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[1]","2.06")}, 35000);
setTimeout( function(){ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[0]","1.32")}, 35000);
setTimeout( function(){ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[1]","1.98")}, 40000);
setTimeout( function(){ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[0]","1.22")}, 40000);
setTimeout( function(){ODBGenerateMsg("Degaussing Y field DONE!","midas","midptf","")},45000);
}
</script>
<script>
function degauss_x_cyclotron_OFF()
{
<!-- Degauss in x (coils 3 & 4) -->
ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[2]","0.69");
ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[4]","0");
setTimeout( function(){ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[2]","3.51")}, 5000);
setTimeout( function(){ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[4]","2.91")}, 5000);
setTimeout( function(){ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[2]","1.47")}, 10000);
setTimeout( function(){ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[4]","0.85")}, 10000);
setTimeout( function(){ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[2]","2.62")}, 15000);
setTimeout( function(){ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[4]","2.01")}, 15000);
setTimeout( function(){ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[2]","2.20")}, 20000);
setTimeout( function(){ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[4]","1.58")}, 20000);
setTimeout( function(){ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[2]","2.45")}, 25000);
setTimeout( function(){ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[4]","1.85")}, 25000);
setTimeout( function(){ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[2]","2.32")}, 30000);
setTimeout( function(){ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[4]","1.71")}, 30000);
setTimeout( function(){ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[2]","2.36")}, 35000);
setTimeout( function(){ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[4]","1.74")}, 35000);
setTimeout( function(){ODBGenerateMsg("Degaussing X field DONE!","midas","midptf","")},40000);
}
</script>
<script>
function degauss_y_cyclotron_OFF()
{
<!-- Degauss in y (coils 5 & 6) -->

ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[1]","0");
ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[0]","0");
setTimeout( function(){ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[1]","3.2")}, 5000);
setTimeout( function(){ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[0]","3.0")}, 5000);
setTimeout( function(){ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[1]","0.71")}, 10000);
setTimeout( function(){ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[0]","0.56")}, 10000);
setTimeout( function(){ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[1]","2.3")}, 15000);
setTimeout( function(){ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[0]","2.11")}, 15000);
setTimeout( function(){ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[1]","1.26")}, 20000);
setTimeout( function(){ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[0]","1.11")}, 20000);
setTimeout( function(){ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[1]","1.96")}, 25000);
setTimeout( function(){ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[0]","1.81")}, 25000);
setTimeout( function(){ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[1]","1.55")}, 30000);
setTimeout( function(){ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[0]","1.41")}, 30000);
setTimeout( function(){ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[1]","1.86")}, 35000);
setTimeout( function(){ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[0]","1.69")}, 35000);
setTimeout( function(){ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[1]","1.76")}, 40000);
setTimeout( function(){ODBSet("/Equipment/PtfWiener/Settings/outputVoltage[0]","1.63")}, 40000);
setTimeout( function(){ODBGenerateMsg("Degaussing Y field DONE!","midas","midptf","")},45000);
}
</script>

<!-- Function to call periodically  -->
<script>
window.setInterval("Refresh()",2000);
function fixedPrecision(value){
  return Math.round(value*1000)/1000;
}
function Refresh() {

  var start = new Date().getTime();
  var req = new Array();
  req[0]= "/Equipment/Move/Control/Destination[0]"
  req[1]= "/Equipment/Move/Control/Destination[1]"
  req[2]= "/Equipment/Move/Control/Destination[2]"
  req[3]= "/Equipment/Move/Control/Destination[3]"
  req[4]= "/Equipment/Move/Control/Destination[4]"
  req[5]= "/Equipment/Move/Variables/Position[0]"
  req[6]= "/Equipment/Move/Variables/Position[1]"
  req[7]= "/Equipment/Move/Variables/Position[2]"
  req[8]= "/Equipment/Move/Variables/Position[3]"
  req[9]= "/Equipment/Move/Variables/Position[4]"
  req[10] = '/Equipment/Move/Variables/Moving'
  req[11] = '/Equipment/Move/Variables/Initializing'
  req[12] = '/Equipment/Move/Variables/Initializing'
  req[13] = '/Equipment/Move/Variables/Initialized'
  req[14] = '/Equipment/Move/Variables/Completed'
  req[15] = '/Programs/feMove/First failed'
  req[16] = '/Equipment/Phidget00/Variables/PH00[7]'
  req[17] = '/Equipment/Phidget00/Variables/PH00[3]'
  req[18] = '/Equipment/Phidget00/Variables/PH00[4]'
  req[19] = '/Equipment/Phidget00/Variables/PH00[5]'
  req[20] = '/Equipment/Phidget00/Variables/PH00[6]'
<!--- Gantry 01 --->
  req[21] = '/Equipment/Move/Control/Destination[5]'
  req[22] = '/Equipment/Move/Control/Destination[6]'
  req[23] = '/Equipment/Move/Control/Destination[7]'
  req[24] = '/Equipment/Move/Control/Destination[8]'
  req[25] = '/Equipment/Move/Control/Destination[9]'
  req[26] = '/Equipment/Move/Variables/Position[5]'
  req[27] = '/Equipment/Move/Variables/Position[6]'
  req[28] = '/Equipment/Move/Variables/Position[7]'
  req[29] = '/Equipment/Move/Variables/Position[8]'
  req[30] = '/Equipment/Move/Variables/Position[9]'
  req[31] = '/Equipment/Phidget01/Variables/PH01[7]'
  req[32] = '/Equipment/Phidget01/Variables/PH01[3]'
  req[33] = '/Equipment/Phidget01/Variables/PH01[4]'
  req[34] = '/Equipment/Phidget01/Variables/PH01[5]'
  req[35] = '/Equipment/Phidget01/Variables/PH01[6]'
<!--- Helmholtz Coil --->
  <!-- First two coils are on different power supply, see ELogs (June 19,2014) -->
  <!-- Next four coils have proper mapping, see ELogs (Nov 13, 2015) -->
  req[36] = '/Equipment/PtfWiener/Variables/senseVoltage[8]'
  req[37] = '/Equipment/PtfWiener/Variables/senseVoltage[9]'
  req[38] = '/Equipment/PtfWiener/Variables/senseVoltage[2]'
  req[39] = '/Equipment/PtfWiener/Variables/senseVoltage[4]'
  req[40] = '/Equipment/PtfWiener/Variables/senseVoltage[1]'
  req[41] = '/Equipment/PtfWiener/Variables/senseVoltage[0]'
  req[42] = '/Equipment/PtfWiener/Variables/current[8]'
  req[43] = '/Equipment/PtfWiener/Variables/current[9]'
  req[44] = '/Equipment/PtfWiener/Variables/current[2]'
  req[45] = '/Equipment/PtfWiener/Variables/current[4]'
  req[46] = '/Equipment/PtfWiener/Variables/current[1]'
  req[47] = '/Equipment/PtfWiener/Variables/current[0]'

  req[48] = '/Equipment/Phidget03/Variables/PH03[7]'
  req[49] = '/Equipment/Phidget03/Variables/PH03[3]'
  req[50] = '/Equipment/Phidget03/Variables/PH03[4]'
  req[51] = '/Equipment/Phidget03/Variables/PH03[5]'
  req[52] = '/Equipment/Phidget03/Variables/PH03[6]'
  req[53] = '/Equipment/Phidget04/Variables/PH04[7]'
  req[54] = '/Equipment/Phidget04/Variables/PH04[3]'
  req[55] = '/Equipment/Phidget04/Variables/PH04[4]'
  req[56] = '/Equipment/Phidget04/Variables/PH04[5]'
  req[57] = '/Equipment/Phidget04/Variables/PH04[6]'



  var result = ODBMGet(req);


  if(result[10].match('y') || result[11].match('y')){
    document.getElementById("gantry_moving").innerHTML = "Gantry is moving."
    document.getElementById("gantry_moving").style.color ="Red"
  } else {
    document.getElementById("gantry_moving").innerHTML = "Gantry is stopped."
    document.getElementById("gantry_moving").style.color ="Black"
  }
  if(result[12].match('y')){
    document.getElementById("gantry_initialized").innerHTML = "Gantry is initializing."
    document.getElementById("gantry_initialized").style.color ="Red"
  }else if(result[13].match('y')){
    document.getElementById("gantry_initialized").style.color ="Black"
    document.getElementById("gantry_initialized").innerHTML = "Gantry is initialized."
  } else {
    document.getElementById("gantry_initialized").innerHTML = "Gantry is not initialized."
    document.getElementById("gantry_initialized").style.color ="Black"
  }

  if(result[14].match('y')){
    document.getElementById("gantry_completed").innerHTML = "Last move was completed."
  } else {
    document.getElementById("gantry_completed").innerHTML = "Last move was not completed."
  }

  <!-- Check the current destination and current position -->
  document.getElementById("phidget0_tilt").innerHTML = fixedPrecision(result[16]);
  document.getElementById("phidget0_mag_x").innerHTML = fixedPrecision(result[17]);
  document.getElementById("phidget0_mag_y").innerHTML = fixedPrecision(result[18]);
  document.getElementById("phidget0_mag_z").innerHTML = fixedPrecision(result[19]);
  document.getElementById("phidget0_totmag").innerHTML = fixedPrecision(result[20]);

  document.getElementById("phidget1_tilt").innerHTML = fixedPrecision(result[31]);
  document.getElementById("phidget1_mag_x").innerHTML = fixedPrecision(result[32]);
  document.getElementById("phidget1_mag_y").innerHTML = fixedPrecision(result[33]);
  document.getElementById("phidget1_mag_z").innerHTML = fixedPrecision(result[34]);
  document.getElementById("phidget1_totmag").innerHTML = fixedPrecision(result[35]);


  document.getElementById("coil1_U").innerHTML = fixedPrecision(result[36]);
  document.getElementById("coil1_I").innerHTML = fixedPrecision(result[42]);
  document.getElementById("coil2_U").innerHTML = fixedPrecision(result[37]);
  document.getElementById("coil2_I").innerHTML = fixedPrecision(result[43]);
  document.getElementById("coil3_U").innerHTML = fixedPrecision(result[38]);
  document.getElementById("coil3_I").innerHTML = fixedPrecision(result[44]);
  document.getElementById("coil4_U").innerHTML = fixedPrecision(result[39]);
  document.getElementById("coil4_I").innerHTML = fixedPrecision(result[45]);
  document.getElementById("coil5_U").innerHTML = fixedPrecision(result[40]);
  document.getElementById("coil5_I").innerHTML = fixedPrecision(result[46]);
  document.getElementById("coil6_U").innerHTML = fixedPrecision(result[41]);
  document.getElementById("coil6_I").innerHTML = fixedPrecision(result[47]);


  document.getElementById("phidget3_tilt").innerHTML = fixedPrecision(result[48]);
  document.getElementById("phidget3_mag_x").innerHTML = fixedPrecision(result[49]);
  document.getElementById("phidget3_mag_y").innerHTML = fixedPrecision(result[50]);
  document.getElementById("phidget3_mag_z").innerHTML = fixedPrecision(result[51]);
  document.getElementById("phidget3_totmag").innerHTML = fixedPrecision(result[52]);


  document.getElementById("phidget4_tilt").innerHTML = fixedPrecision(result[53]);
  document.getElementById("phidget4_mag_x").innerHTML = fixedPrecision(result[54]);
  document.getElementById("phidget4_mag_y").innerHTML = fixedPrecision(result[55]);
  document.getElementById("phidget4_mag_z").innerHTML = fixedPrecision(result[56]);
  document.getElementById("phidget4_totmag").innerHTML = fixedPrecision(result[57]);

  document.getElementById("datetime").innerHTML = new Date().toString();

  <!-- Check the current messages -->
  var mess = ODBGetMsg(15)
  var innerhtml = "<font size=-2><ul>"
  for (var i = 0; i < mess.length; i++) {
    if(mess[i]!=""){
      if(mess[i].search("ERROR]") == -1){
        innerhtml += "<li>" + mess[i]  + "</li>"
      }else{
        innerhtml += "<li> <font color=\"red\" >" + mess[i]  + "</font></li>"
      }
    }
  }
  innerhtml += "</ul></font>"
  document.getElementById("mmessages").innerHTML = innerhtml;

  var end = new Date().getTime();
  var time = end - start;
  document.getElementById("exectime").innerHTML = time
}
</script>

<!-- Function to check numeric value  -->

<!-- TODO: Check wrt maxVoltage first before setting
 if(tested > ODBGet('/Equipment/PtfWiener/Settings/maxVoltage[0]')){
alert("Please enter a value below the maximum allowed voltage"); } -->

<script>
function checkInput(value){
  var tested = parseFloat(value);
  if(isNaN(tested)){
    tested = 0.0;
    alert("Please enter numeric value");
  }
  return tested;
}

function checkMax(value, coil){
  checkInput(value);
  var tested = parseFloat(value);
  var max_val = ODBGet('/Equipment/PtfWiener/Settings/maxVoltage[' + (coil-2) + ']');
  if(coil < 2){
	    max_val = ODBGet('/Equipment/PtfWiener/Settings/maxVoltage[' + (coil+8) + ']');
	    }
  if(tested > max_val){
    tested = 0.0;
    alert("Please enter a value lower than the maximum allowed: "+ max_val);
  }
  return tested;

}
<!-- Function to update destination values  -->
function printValue(coil){
var x = document.getElementById("textbox"+coil);
var y = document.getElementById("slider"+coil);
x.value = y.value;
}

function updateC1_U(field) {
ODBSet('/Equipment/PtfWiener/Settings/outputVoltage[8]',checkMax(field.value,0));
printValue(1);
}

function updateC2_U(field) {
ODBSet('/Equipment/PtfWiener/Settings/outputVoltage[9]',checkMax(field.value,1));
printValue(2);
}

function updateC3_U(field) {
ODBSet('/Equipment/PtfWiener/Settings/outputVoltage[2]',checkMax(field.value,2));
printValue(3);
}

function updateC4_U(field) {
ODBSet('/Equipment/PtfWiener/Settings/outputVoltage[4]',checkMax(field.value,3));
printValue(4);
}

function updateC5_U(field) {
ODBSet('/Equipment/PtfWiener/Settings/outputVoltage[1]',checkMax(field.value,4));
printValue(5);
}

function updateC6_U(field) {
ODBSet('/Equipment/PtfWiener/Settings/outputVoltage[0]',checkMax(field.value,5));
printValue(6);
}


function updateC1_I(field) {
ODBSet('/Equipment/PtfWiener/Settings/outputCurrent[8]',checkInput(field.value));
printValue();
}

function updateC2_I(field) {
ODBSet('/Equipment/PtfWiener/Settings/outputCurrent[9]',checkInput(field.value));
printValue();
}

function updateC3_I(field) {
ODBSet('/Equipment/PtfWiener/Settings/outputCurrent[2]',checkInput(field.value));
printValue();
}

function updateC4_I(field) {
ODBSet('/Equipment/PtfWiener/Settings/outputCurrent[4]',checkInput(field.value));
printValue();
}

function updateC5_I(field) {
ODBSet('/Equipment/PtfWiener/Settings/outputCurrent[1]',checkInput(field.value));
printValue();
}

function updateC6_I(field) {
ODBSet('/Equipment/PtfWiener/Settings/outputCurrent[0]',checkInput(field.value));
printValue();
}


</script>

<style>
#header {
    margin-bottom: 0;
}
#form1 {
    display: block;
    margin: auto;
    margin-top: 1em;
    margin-bottom: 1em;
}
</style>

</head>



<!-- ----------------- BODY ------------->
<body onload="Refresh();">


<div id="container" style="">

<div id="header">
    <h1>Helmholtz Coil Control</h1>
</div>

<div id="menu" style="background-color:#FFD700;height:700px;width:450px;float:left;">
<!-- This works because it's a form. The details are in mhttpd.cxx -->
<form name="form1" id="form1" method="Get">
	<input value="Status"    name="cmd" type="submit">
	<input value="ODB"       name="cmd" type="submit">
	<input value="History"   name="cmd" type="submit">
</tr>
</form>

<b>Status of Current in Coils and Magnet Field</b><br>
<ul>
<li id="gantry_moving"></li>
<li id="gantry_initialized"></li>
<li id="gantry_completed"></li>
</ul>

<!--- Note: variables can only be shown once! --->
<ul>
<li>Phidget Measurements:</li>
</ul>

<div id="div_ltop"> <div id="div_lmargin"></div>
<div id="div_lshort"></div><div id='div_lmarginsl'></div>
<div id="div_ldestsl" >Phidget 0</div>
<div id='div_lmargin'></div><div id="div_ldest">Phidget 1</div> </div>

<script>
var Names = new Array("tilt","mag_x","mag_y","mag_z","totmag");
var Units = new Array("deg","G","G","G","G");
for (var i=0;i<5;i++){
document.write("<div id='div_ltop'><div id='div_lmargin'></div>");
document.write("<div id='div_lshort'> " + Names[i] + " (" + Units[i] + ") </div>");
document.write("<div id='div_lmarginsl'></div><div id='div_ldestsl'><span id='phidget0_" + Names[i] + "'></span></div>");
document.write("<div id='div_lmargin'></div><div id='div_posn'><span id='phidget1_" + Names[i] + "'></span> </div>");
document.write("<div id='div_pos'>  </span>  </div></div>");
}
</script>


<div id="div_ltop"> <div id="div_lmargin"></div>
<div id="div_lshort"></div><div id='div_lmarginsl'></div>
<div id="div_ldestsl" >Phidget 3</div>
<div id='div_lmargin'></div><div id="div_ldest">Phidget 4</div> </div>

<script>
var Names = new Array("tilt","mag_x","mag_y","mag_z","totmag");
var Units = new Array("deg","G","G","G","G");
for (var i=0;i<5;i++){
document.write("<div id='div_ltop'><div id='div_lmargin'></div>");
document.write("<div id='div_lshort'> " + Names[i] + " (" + Units[i] + ") </div>");
document.write("<div id='div_lmarginsl'></div><div id='div_ldestsl'><span id='phidget3_" + Names[i] + "'> </div>");
document.write("<div id='div_lmargin'></div><div id='div_posn'><span id='phidget4_" + Names[i] + "'></span></div>");
document.write("<div id='div_pos'>  </span>  </div></div>");
}
</script>



<div id="div_ltop"> <div id="div_lmargin"></div><div id="div_lshort"></div><div id="div_ldest" ></div> <div id="div_ldest"> </div> </div>
<ul>
<li>Coil Measurements:</li>
</ul>

<div id="div_ltop"> <div id="div_lmargin"></div>
<div id="div_lshort"></div><div id='div_lmarginsl'></div>
<div id="div_ldestsl" >Voltage </div>
<div id='div_lmargin'></div><div id="div_dest">Current </div> </div>

<script>
for (var i=1;i<=6;i++){
document.write("<div id='div_ltop'><div id='div_lmargin'></div>");
document.write("<div id='div_lshort'> Coil" + i + " </div>");
document.write("<div id='div_lmarginsl'></div><div id='div_ldestsl'><span id='coil" + i + "_U'></span> </div>");
document.write("<div id='div_lmargin'></div><div id='div_pos'><span id='coil" + i + "_I'></span> </div>");
document.write("<div id='div_pos'>  </span>  </div></div>");
}
</script>

</div>

<div id="content" style="background-color:#EEEEEE;height:500px;width:500px;float:left;">


<b>Helmholtz Coil Control</b>
<br>
<button class="button red" onclick="coil_stop()" id="stop_button">Shutdown Power Now!!</button> <br>
<button type="button" onclick="coil_switch_on()" id="stop_button">Switch Coils ON</button><br>
<button type="button" onclick="degauss_x_cyclotron_ON()" id="stop_button">Degauss with X Coils 3&4 (Cyclotron ON)</button><br>
<button type="button" onclick="degauss_y_cyclotron_ON()" id="stop_button">Degauss with Y Coils 5&6 (Cyclotron ON)</button><br>
<button type="button" onclick="degauss_x_cyclotron_OFF()" id="stop_button">Degauss with X Coils 3&4 (Cyclotron OFF)</button><br>
<button type="button" onclick="degauss_y_cyclotron_OFF()" id="stop_button">Degauss with Y Coils 5&6 (Cyclotron OFF)</button>
<br>
<div id="div_top"> <div id="div_margin"></div>
<div id="div_short"></div><div id="div_dest" > Voltage (V) </div>

<script>
for (var i=1;i<=6;i++){
document.write("<div id='div_top'><div id='div_margin'></div>");
document.write("<div id='div_short'> Coil" + i + " </div>");
document.write("<div id='div_destsl' ><input id='slider"+i+"' type='number' min=0 max=15 step=0.01 default=0 size=0.1 onchange='updateC" + i + "_U(this);'/> </div> ");
}
</script>

</div>

<div id="content" style=";height:400px;width:600px;float:left;">

<b>MIDAS Messages</b>
<p id="mmessages"></p>

</div>

<div id="footer" style="background-color:#FFA500;clear:both;text-align:center;">
<p>Last updated:</p>
<p id="datetime"></p>
<p>Javascript executed in <span id="exectime"></span> ms. </p>
</div>

</div>

</body>
</html>
